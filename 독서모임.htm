<!doctype html>
<html lang="ko" prefix="
    schema: https://schema.org/
    dcterms: http://purl.org/dc/terms/
    foaf: http://xmlns.com/foaf/0.1/
    x: https://example.org/reading#
  ">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ë…ì„œê¸°ë¡ - ìš”ì¼ë³„ ì•„ê¸°ìê¸° ë¡œê·¸ (RDF)</title>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "ë…ì„œê¸°ë¡ (ìš”ì¼ë³„) - RDF ì§€ì›",
    "applicationCategory": "LifestyleApplication",
    "operatingSystem": "Any"
  }
  </script>

  <style>
    :root {
      --bg1: #fff7fb;
      --bg2: #f3fbff;
      --card: #ffffffcc;
      --ink: #2b2b2b;
      --muted: #666;
      --stroke: #00000010;
      --shadow: 0 12px 30px rgba(0, 0, 0, .08);
      --radius: 22px;
      --focus: 0 0 0 4px rgba(106, 211, 255, .25);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      color: var(--ink);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, "Apple SD Gothic Neo";
      background:
        radial-gradient(1200px 700px at 15% 10%, var(--bg2), transparent 60%),
        radial-gradient(900px 600px at 80% 20%, var(--bg1), transparent 55%),
        linear-gradient(135deg, #ffffff, #f6fbff);
      min-height: 100vh;
      overflow-x: hidden;
    }

    header {
      padding: 22px 18px 8px;
      position: sticky;
      top: 0;
      backdrop-filter: blur(12px);
      background: linear-gradient(180deg, rgba(255, 255, 255, .85), rgba(255, 255, 255, .55));
      border-bottom: 1px solid var(--stroke);
      z-index: 10;
    }

    .wrap {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 16px 28px;
    }

    .topRow {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    h1 {
      margin: 0;
      font-size: 22px;
      letter-spacing: -.3px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .badge {
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      background: linear-gradient(90deg, rgba(255, 122, 168, .18), rgba(106, 211, 255, .18));
      border: 1px solid var(--stroke);
      color: #444;
    }

    .actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }

    button,
    .chip {
      border: 1px solid var(--stroke);
      background: #fff;
      padding: 10px 12px;
      border-radius: 14px;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(0, 0, 0, .06);
      transition: transform .12s ease, box-shadow .12s ease;
      font-weight: 650;
      color: #2d2d2d;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 26px rgba(0, 0, 0, .08);
    }

    button:active {
      transform: translateY(0px) scale(.99);
    }

    button:focus {
      outline: none;
      box-shadow: var(--focus), 0 12px 26px rgba(0, 0, 0, .08);
    }

    .danger {
      border-color: rgba(255, 0, 0, .12);
    }

    .ghost {
      background: linear-gradient(90deg, rgba(255, 122, 168, .12), rgba(106, 211, 255, .12));
    }

    .grid {
      display: grid;
      grid-template-columns: 380px 1fr;
      gap: 16px;
      margin-top: 14px;
    }

    @media (max-width: 980px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }

    .panel {
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      position: relative;
    }

    .panel::before {
      content: "";
      position: absolute;
      inset: -60px;
      background:
        radial-gradient(220px 140px at 20% 20%, rgba(255, 122, 168, .20), transparent 60%),
        radial-gradient(260px 180px at 85% 30%, rgba(106, 211, 255, .18), transparent 60%),
        radial-gradient(260px 180px at 55% 90%, rgba(122, 229, 130, .12), transparent 60%);
      pointer-events: none;
      filter: blur(1px);
    }

    .panel>* {
      position: relative;
    }

    .panelHead {
      padding: 16px 16px 10px;
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
    }

    .panelHead h2 {
      margin: 0;
      font-size: 16px;
      letter-spacing: -.2px;
    }

    .muted {
      color: var(--muted);
      font-size: 12px;
      line-height: 1.4;
    }

    .tabs {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      padding: 0 16px 12px;
    }

    .chip {
      box-shadow: none;
      font-weight: 700;
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(255, 255, 255, .7);
    }

    .chip[data-active="true"] {
      background: linear-gradient(90deg, rgba(255, 122, 168, .22), rgba(106, 211, 255, .22));
      border-color: rgba(255, 122, 168, .18);
    }

    .form {
      padding: 0 16px 16px;
      display: grid;
      gap: 10px;
    }

    label {
      display: grid;
      gap: 6px;
      font-size: 12px;
      color: #555;
      font-weight: 700;
    }

    input,
    textarea,
    select {
      width: 100%;
      border: 1px solid var(--stroke);
      border-radius: 14px;
      padding: 10px 12px;
      font-size: 14px;
      background: rgba(255, 255, 255, .9);
      outline: none;
    }

    input:focus,
    textarea:focus,
    select:focus {
      box-shadow: var(--focus);
    }

    textarea {
      min-height: 92px;
      resize: vertical;
    }

    .row2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    .row3 {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 10px;
    }

    @media (max-width: 420px) {

      .row2,
      .row3 {
        grid-template-columns: 1fr;
      }
    }

    .preview {
      display: flex;
      gap: 10px;
      align-items: center;
      padding: 10px 12px;
      border: 1px dashed rgba(0, 0, 0, .12);
      border-radius: 16px;
      background: rgba(255, 255, 255, .6);
    }

    .thumb {
      width: 56px;
      height: 56px;
      border-radius: 14px;
      border: 1px solid rgba(0, 0, 0, .08);
      background: linear-gradient(135deg, rgba(255, 122, 168, .18), rgba(106, 211, 255, .18));
      overflow: hidden;
      display: grid;
      place-items: center;
      flex: 0 0 auto;
    }

    .thumb img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .thumb span {
      font-size: 22px;
      opacity: .8;
    }

    .previewText {
      font-size: 12px;
      color: #555;
      line-height: 1.35;
    }

    .saveBar {
      display: flex;
      gap: 10px;
      padding: 0 16px 16px;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }

    .saveBar .left {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
    }

    .editBanner {
      margin: 0 16px 12px;
      padding: 10px 12px;
      border-radius: 16px;
      border: 1px solid rgba(0, 0, 0, .08);
      background: rgba(255, 255, 255, .7);
      display: none;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }

    .editBanner[data-on="true"] {
      display: flex;
    }

    .editTitle {
      font-weight: 900;
      font-size: 12px;
      color: #333;
    }

    .editSub {
      font-size: 12px;
      color: #666;
    }

    .listWrap {
      padding: 12px 16px 16px;
    }

    .stats {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }

    .pill {
      font-size: 12px;
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(255, 255, 255, .75);
      border: 1px solid var(--stroke);
    }

    .cards {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    @media (max-width: 860px) {
      .cards {
        grid-template-columns: 1fr;
      }
    }

    .card {
      border-radius: 18px;
      border: 1px solid var(--stroke);
      background: rgba(255, 255, 255, .78);
      box-shadow: 0 12px 28px rgba(0, 0, 0, .06);
      overflow: hidden;
      transition: transform .12s ease;
    }

    .card:hover {
      transform: translateY(-1px);
    }

    .cardHead {
      display: flex;
      gap: 10px;
      padding: 12px;
      align-items: flex-start;
    }

    .cover {
      width: 72px;
      height: 72px;
      border-radius: 16px;
      border: 1px solid rgba(0, 0, 0, .08);
      overflow: hidden;
      flex: 0 0 auto;
      background: linear-gradient(135deg, rgba(255, 122, 168, .18), rgba(106, 211, 255, .18));
      display: grid;
      place-items: center;
    }

    .cover img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .cover span {
      font-size: 26px;
    }

    .meta {
      display: grid;
      gap: 4px;
      width: 100%;
      min-width: 0;
    }

    .titleLine {
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }

    .bookTitle {
      font-weight: 900;
      letter-spacing: -.2px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 100%;
    }

    .mini {
      font-size: 11px;
      color: #555;
      background: rgba(0, 0, 0, .04);
      border: 1px solid rgba(0, 0, 0, .06);
      padding: 4px 8px;
      border-radius: 999px;
    }

    .cardBody {
      padding: 0 12px 12px;
      display: grid;
      gap: 8px;
    }

    .note {
      font-size: 13px;
      line-height: 1.55;
      white-space: pre-wrap;
      word-break: break-word;
      border-radius: 14px;
      padding: 10px 10px;
      border: 1px solid rgba(0, 0, 0, .06);
      background: rgba(255, 255, 255, .6);
    }

    .cardActions {
      display: flex;
      gap: 8px;
      justify-content: flex-end;
      flex-wrap: wrap;
      padding: 0 12px 12px;
    }

    .smallBtn {
      padding: 8px 10px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 850;
      box-shadow: none;
    }

    /* ë°˜ì§ì´ */
    .sparkle {
      position: fixed;
      width: 10px;
      height: 10px;
      border-radius: 4px;
      pointer-events: none;
      z-index: 9999;
      animation: pop .7s ease-out forwards;
      opacity: .95;
      filter: drop-shadow(0 10px 16px rgba(0, 0, 0, .18));
    }

    @keyframes pop {
      0% {
        transform: translate(0, 0) scale(.9) rotate(0deg);
        opacity: 0;
      }

      15% {
        opacity: 1;
      }

      100% {
        transform: translate(var(--dx), var(--dy)) scale(.2) rotate(220deg);
        opacity: 0;
      }
    }

    footer {
      padding: 10px 16px 24px;
      color: #777;
      font-size: 12px;
      text-align: center;
    }

    code.kbd {
      background: rgba(0, 0, 0, .06);
      border: 1px solid rgba(0, 0, 0, .08);
      padding: 2px 6px;
      border-radius: 8px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size: 11px;
    }

    /* --- Home Screen --- */
    #homeScreen {
      position: fixed;
      inset: 0;
      z-index: 9999;
      background:
        radial-gradient(circle at 50% 30%, #fff0f5, transparent 60%),
        linear-gradient(135deg, #fdfbf7, #fff7fb);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 20px;
      transition: opacity .4s ease, visibility .4s;
    }

    #homeScreen[aria-hidden="true"] {
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }

    .homeTitle {
      font-size: 42px;
      font-weight: 900;
      background: linear-gradient(45deg, #ff7aa8, #6ad3ff);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 16px;
      animation: bounce 2s infinite;
    }

    .homeSub {
      font-size: 18px;
      color: #666;
      margin-bottom: 40px;
      max-width: 400px;
      line-height: 1.5;
    }

    .bigBtn {
      font-size: 20px;
      padding: 16px 32px;
      border-radius: 999px;
      background: linear-gradient(90deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%);
      color: #fff;
      border: none;
      box-shadow: 0 10px 20px rgba(255, 154, 158, 0.4);
      cursor: pointer;
      transition: transform .2s, box-shadow .2s;
      font-weight: bold;
    }

    .bigBtn:hover {
      transform: translateY(-4px);
      box-shadow: 0 14px 28px rgba(255, 154, 158, 0.6);
    }

    .floatingEmoji {
      position: absolute;
      font-size: 40px;
      opacity: 0.6;
      animation: float 6s ease-in-out infinite;
    }

    /* --- Baepsae (Korean Crow Tit) CSS Art --- */
    .baepsae-container {
      position: relative;
      width: 140px;
      height: 130px;
      margin-bottom: 20px;
      animation: bounceBird 2s infinite ease-in-out;
    }

    .baepsae {
      width: 100%;
      height: 100%;
      background: #ffffff;
      border-radius: 55% 55% 45% 45%;
      position: relative;
      box-shadow:
        inset 0 -10px 20px rgba(0, 0, 0, 0.05),
        0 15px 30px rgba(0, 0, 0, 0.1);
    }

    .baepsae::before,
    .baepsae::after {
      /* Eyes */
      content: '';
      position: absolute;
      top: 42%;
      width: 10px;
      height: 10px;
      background: #222;
      border-radius: 50%;
      animation: blink 4s infinite;
    }

    .baepsae::before {
      left: 32%;
    }

    .baepsae::after {
      right: 32%;
    }

    .beak {
      position: absolute;
      top: 45%;
      left: 50%;
      transform: translateX(-50%);
      width: 8px;
      height: 6px;
      background: #ffaa00;
      border-radius: 2px 2px 6px 6px;
    }

    .cheek {
      position: absolute;
      top: 48%;
      width: 24px;
      height: 16px;
      background: #ffb7b2;
      opacity: 0.5;
      border-radius: 50%;
    }

    .cheek.left {
      left: 15%;
    }

    .cheek.right {
      right: 15%;
    }

    .wing {
      position: absolute;
      top: 50%;
      width: 30px;
      height: 45px;
      background: #fdfdfd;
      border: 1px solid rgba(0, 0, 0, 0.03);
      border-radius: 50% 20% 50% 50%;
      transform-origin: top center;
      transition: transform .3s;
    }

    .wing.left {
      left: -10px;
      transform: rotate(15deg);
    }

    .wing.right {
      right: -10px;
      transform: scaleX(-1) rotate(15deg);
    }

    .baepsae-container.mini {
      width: 50px;
      height: 46px;
      margin: 0;
      animation: bounceBird 3s infinite ease-in-out;
    }

    .baepsae-container.mini .baepsae::before,
    .baepsae-container.mini .baepsae::after {
      width: 4px;
      height: 4px;
      top: 40%;
    }

    .baepsae-container.mini .beak {
      width: 4px;
      height: 3px;
      top: 43%;
    }

    .baepsae-container.mini .cheek {
      width: 8px;
      height: 6px;
      top: 46%;
    }

    .baepsae-container.mini .wing {
      width: 10px;
      height: 16px;
      top: 52%;
    }

    /* Positioning utilities */
    .pos-abs {
      position: absolute;
      z-index: -1;
      opacity: 0.8;
    }

    .pos-home-1 {
      top: 15%;
      left: 10%;
      transform: rotate(-10deg);
    }

    .pos-home-2 {
      bottom: 20%;
      right: 10%;
      transform: rotate(10deg) scale(0.8);
    }

    .pos-app-1 {
      top: 120px;
      right: 5%;
      transform: rotate(15deg);
      opacity: 0.4;
      pointer-events: none;
    }

    .pos-app-2 {
      bottom: 50px;
      left: 5%;
      transform: rotate(-5deg) scale(1.2);
      opacity: 0.3;
      pointer-events: none;
    }

    /* Animation */
    @keyframes bounceBird {

      0%,
      100% {
        transform: translateY(0);
      }

      50% {
        transform: translateY(-10px);
      }
    }

    @keyframes blink {

      0%,
      48%,
      52%,
      100% {
        transform: scaleY(1);
      }

      50% {
        transform: scaleY(0.1);
      }
    }

    /* Random Background Baepsae */
    .bg-baepsae {
      position: fixed;
      z-index: -1;
      opacity: 0.15;
      pointer-events: none;
      filter: grayscale(0.2);
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0);
      }

      50% {
        transform: translateY(-20px);
      }
    }

    @keyframes bounce {

      0%,
      20%,
      50%,
      80%,
      100% {
        transform: translateY(0);
      }

      40% {
        transform: translateY(-20px);
      }

      60% {
        transform: translateY(-10px);
      }
    }

    #appContainer {
      transition: opacity .4s ease;
    }

    #appContainer[aria-hidden="true"] {
      display: none;
    }
  </style>
</head>

<body typeof="schema:WebPage">

  <section id="homeScreen">
    <div class="floatingEmoji" style="top:10%; left:10%; animation-delay:0s">â˜ï¸</div>
    <div class="floatingEmoji" style="top:20%; right:15%; animation-delay:1s">ğŸˆ</div>
    <div class="floatingEmoji" style="bottom:15%; left:20%; animation-delay:2s">ğŸ“š</div>

    <!-- ì˜¤ëª©ëˆˆì´ (ë±ìƒˆ) ë©”ì¸ -->
    <div class="baepsae-container">
      <div class="wing left"></div>
      <div class="wing right"></div>
      <div class="baepsae">
        <div class="cheek left"></div>
        <div class="cheek right"></div>
        <div class="beak"></div>
      </div>
    </div>

    <!-- ì˜¤ëª©ëˆˆì´ ì¥ì‹ 1 -->
    <div class="baepsae-container mini pos-abs pos-home-1">
      <div class="wing left"></div>
      <div class="wing right"></div>
      <div class="baepsae">
        <div class="cheek left"></div>
        <div class="cheek right"></div>
        <div class="beak"></div>
      </div>
    </div>

    <!-- ì˜¤ëª©ëˆˆì´ ì¥ì‹ 2 -->
    <div class="baepsae-container mini pos-abs pos-home-2">
      <div class="wing left"></div>
      <div class="wing right"></div>
      <div class="baepsae">
        <div class="cheek left"></div>
        <div class="cheek right"></div>
        <div class="beak"></div>
      </div>
    </div>

    <div class="homeTitle">ë‚˜ë§Œì˜ ë…ì„œ ê¸°ë¡ì¥</div>
    <div class="homeSub">
      ì¹œêµ¬ë“¤ê³¼ í•¨ê»˜ ì½ì€ ì±…ì„ ê¸°ë¡í•˜ê³ <br />
      ë‚˜ë§Œì˜ ì˜ˆìœ ì„œì¬ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”! âœ¨
    </div>
    <button class="bigBtn" id="btnStart">ì‹œì‘í•˜ê¸° ğŸš€</button>
  </section>

  <div id="appContainer" aria-hidden="true" style="display:none">
    <header>
      <div class="wrap">
        <div class="topRow">
          <h1>
            <!-- í—¤ë” ë±ìƒˆ -->
            <div class="baepsae-container mini"
              style="display:inline-block; vertical-align:middle; margin-right:8px; animation-duration:4s;">
              <div class="wing left"></div>
              <div class="wing right"></div>
              <div class="baepsae">
                <div class="cheek left"></div>
                <div class="cheek right"></div>
                <div class="beak"></div>
              </div>
            </div>
            ğŸ“š ë…ì„œê¸°ë¡
            <span class="badge">ìš”ì¼ë³„ Â· ì‚¬ì§„ Â· ê¸€ììƒ‰ Â· ìˆ˜ì • Â· ì €ì¥/ë°±ì—…/ë³µì›</span>
          </h1>
          <div class="actions">
            <button class="ghost" id="btnGoHome" title="í™ˆ í™”ë©´ìœ¼ë¡œ ì´ë™">ğŸ  í™ˆ</button>
            <button class="ghost" id="btnBackup" title="ê¸°ë¡ ë°±ì—…(JSON ë‹¤ìš´ë¡œë“œ)">ğŸ’¾ ë°±ì—…</button>
            <button class="ghost" id="btnRestore" title="ë°±ì—… íŒŒì¼ë¡œ ë³µì›">ğŸ“¥ ë³µì›</button>
            <input id="restoreFile" type="file" accept="application/json" style="display:none" />
            <button class="danger" id="btnReset" title="ì „ì²´ ê¸°ë¡ ì‚­ì œ">ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ</button>
          </div>
        </div>
        <div class="muted">
          âœ… ìë™ì €ì¥(localStorage) Â· ğŸ’¾ ë°±ì—…/ğŸ“¥ ë³µì›(JSON) Â· ë‹¨ì¶•í‚¤: <code class="kbd">Ctrl</code> + <code class="kbd">Enter</code>
          ì €ì¥
        </div>
      </div>
    </header>

    <main class="wrap" style="position:relative;">
      <!-- ì•± ë°°ê²½ ë±ìƒˆ 1 -->
      <div class="baepsae-container mini pos-abs pos-app-1">
        <div class="wing left"></div>
        <div class="wing right"></div>
        <div class="baepsae">
          <div class="cheek left"></div>
          <div class="cheek right"></div>
          <div class="beak"></div>
        </div>
      </div>
      <!-- ì•± ë°°ê²½ ë±ìƒˆ 2 -->
      <div class="baepsae-container mini pos-abs pos-app-2">
        <div class="wing left"></div>
        <div class="wing right"></div>
        <div class="baepsae">
          <div class="cheek left"></div>
          <div class="cheek right"></div>
          <div class="beak"></div>
        </div>
      </div>

      <section class="grid">
        <!-- ì…ë ¥ íŒ¨ë„ -->
        <div class="panel" aria-label="ê¸°ë¡ ì…ë ¥">
          <div class="panelHead">
            <div>
              <h2 id="formTitle">âœï¸ ì˜¤ëŠ˜ì˜ ê¸°ë¡</h2>
              <div class="muted" id="formSubtitle">ìš”ì¼ íƒ­ì„ ê³ ë¥´ê³ , ì±… ì •ë³´ë¥¼ ì ì–´ ì €ì¥í•˜ì„¸ìš”.</div>
            </div>
            <div class="muted" id="activeDayLabel"></div>
          </div>

          <div class="tabs" id="dayTabs" role="tablist" aria-label="ìš”ì¼ ì„ íƒ"></div>

          <!-- âœ… ìˆ˜ì • ëª¨ë“œ ë°°ë„ˆ -->
          <div class="editBanner" id="editBanner" data-on="false">
            <div>
              <div class="editTitle">âœï¸ ìˆ˜ì • ëª¨ë“œ</div>
              <div class="editSub" id="editInfo">ì„ íƒí•œ ê¸°ë¡ì„ ìˆ˜ì • ì¤‘ì´ì—ìš”.</div>
            </div>
            <button type="button" class="danger smallBtn" id="btnCancelEdit">ì·¨ì†Œ</button>
          </div>

          <form class="form" id="logForm">
            <label>
              ì±… ì œëª©
              <input id="title" type="text" placeholder="ì˜ˆ: ë¯¸ì›€ë°›ì„ ìš©ê¸°" required />
            </label>

            <div class="row2">
              <label>
                ì €ì(ì„ íƒ)
                <input id="author" type="text" placeholder="ì˜ˆ: ê¸°ì‹œë¯¸ ì´ì¹˜ë¡œ" />
              </label>
              <label>
                ì½ì€ ë‚ ì§œ
                <input id="dateRead" type="date" />
              </label>
            </div>

            <div class="row3">
              <label>
                ë¶„ë¥˜(ì„ íƒ)
                <select id="category">
                  <option value="">(ì„ íƒ)</option>
                  <option>ì—ì„¸ì´</option>
                  <option>ìê¸°ê³„ë°œ</option>
                  <option>ì†Œì„¤</option>
                  <option>ì¸ë¬¸/ì‚¬íšŒ</option>
                  <option>ê²½ì œ/ê²½ì˜</option>
                  <option>ê³¼í•™/ê¸°ìˆ </option>
                  <option>ê¸°íƒ€</option>
                </select>
              </label>
              <label>
                í‰ì (ì„ íƒ)
                <select id="rating">
                  <option value="">(ì„ íƒ)</option>
                  <option value="1">â­</option>
                  <option value="2">â­â­</option>
                  <option value="3">â­â­â­</option>
                  <option value="4">â­â­â­â­</option>
                  <option value="5">â­â­â­â­â­</option>
                </select>
              </label>
              <label>
                ê¸€ì ìƒ‰
                <input id="textColor" type="color" value="#2b2b2b" />
              </label>
            </div>

            <label>
              í•œ ì¤„ ë©”ëª¨ / ëŠë‚€ ì 
              <textarea id="note" placeholder="ì˜ˆ: ì˜¤ëŠ˜ì€ 'ìš©ê¸°'ê°€ ê°ì •ì´ ì•„ë‹ˆë¼ ìŠµê´€ì´ë¼ëŠ” ë¬¸ì¥ì´ ì¸ìƒì ì´ì—ˆë‹¤."></textarea>
            </label>

            <label>
              íƒœê·¸(ì‰¼í‘œë¡œ êµ¬ë¶„, ì„ íƒ)
              <input id="tags" type="text" placeholder="ì˜ˆ: ì„±ì¥, ê´€ê³„, ë§ˆìŒ" />
            </label>

            <label>
              ì‚¬ì§„(ì„ íƒ) â€” í‘œì§€/ë©”ëª¨/ì¸ìƒ ê¹Šì€ êµ¬ì ˆ
              <input id="photo" type="file" accept="image/*" />
            </label>

            <div class="preview" id="photoPreview" aria-live="polite">
              <div class="thumb" id="thumb"><span>ğŸ–¼ï¸</span></div>
              <div class="previewText" id="previewText">
                ì‚¬ì§„ì„ ì„ íƒí•˜ë©´ ë¯¸ë¦¬ë³´ê¸°ê°€ ë³´ì—¬ìš”. (ì €ì¥ì€ base64ë¡œ localStorageì— ì €ì¥)
              </div>
            </div>

            <div class="saveBar">
              <div class="left">
                <button type="submit" id="btnSave">âœ¨ ì €ì¥í•˜ê¸°</button>
                <button type="button" id="btnClearForm" class="ghost">ğŸ§¼ ì…ë ¥ ì§€ìš°ê¸°</button>
              </div>
              <div class="muted" id="hint"></div>
            </div>
          </form>
        </div>

        <!-- ëª©ë¡ íŒ¨ë„ -->
        <div class="panel" aria-label="ê¸°ë¡ ëª©ë¡">
          <div class="panelHead">
            <div>
              <h2>ğŸ—‚ï¸ ìš”ì¼ë³„ ê¸°ë¡</h2>
              <div class="muted">ì¹´ë“œì—ì„œ âœï¸ ìˆ˜ì •í•˜ë©´ ì™¼ìª½ í¼ì— ë¶ˆëŸ¬ì™€ í¸ì§‘í•  ìˆ˜ ìˆì–´ìš”.</div>
            </div>
            <div class="muted" id="todayChip"></div>
          </div>

          <div class="listWrap">
            <div class="stats" id="stats"></div>
            <div class="cards" id="cards" aria-live="polite"></div>
          </div>
        </div>
      </section>
    </main>

    ì €ì¥: ìë™(localStorage) + ë°±ì—…/ë³µì›(JSON)
    </footer>
  </div>

  <script>
    (() => {
      const DAYS = [
        { key: "mon", label: "ì›”", emoji: "ğŸŒ™" },
        { key: "tue", label: "í™”", emoji: "ğŸ”¥" },
        { key: "wed", label: "ìˆ˜", emoji: "ğŸ€" },
        { key: "thu", label: "ëª©", emoji: "ğŸ§" },
        { key: "fri", label: "ê¸ˆ", emoji: "ğŸˆ" },
        { key: "sat", label: "í† ", emoji: "ğŸŒ¼" },
        { key: "sun", label: "ì¼", emoji: "ğŸŒˆ" }
      ];

      const LS_KEY = "readingLogs.v1";
      const el = (id) => document.getElementById(id);

      const state = {
        activeDayKey: guessTodayKey(),
        db: loadDB(),
        // âœ… ìˆ˜ì • ëª¨ë“œ ìƒíƒœ
        editing: {
          on: false,
          recordId: null,
          originalDayKey: null,
          keepPhotoIfNotChanged: true
        }
      };

      // ---------- init ----------
      renderDayTabs();
      setActiveDay(state.activeDayKey);
      wireForm();
      wireBackupRestore();
      wireReset();
      wireEditCancel();
      setTodayChip();
      renderStats();
      renderCards();
      generateBaepsaeFlock(30);

      // --- Home Screen Logic ---
      const homeScreen = el("homeScreen");
      const appContainer = el("appContainer");
      const btnStart = el("btnStart");
      const btnGoHome = el("btnGoHome");

      // Show App
      btnStart.addEventListener("click", () => {
        homeScreen.setAttribute("aria-hidden", "true");
        appContainer.removeAttribute("aria-hidden");
        appContainer.style.display = "block";
        sparkleBurst(window.innerWidth / 2, window.innerHeight / 2);
      });

      // Go Home
      btnGoHome.addEventListener("click", () => {
        appContainer.setAttribute("aria-hidden", "true");
        appContainer.style.display = "none";
        homeScreen.removeAttribute("aria-hidden");
      });

      // ---------- helpers ----------
      function guessTodayKey() {
        const d = new Date().getDay(); // 0=ì¼, 1=ì›” ...
        const map = ["sun", "mon", "tue", "wed", "thu", "fri", "sat"];
        return map[d] || "mon";
      }

      function loadDB() {
        const raw = localStorage.getItem(LS_KEY);
        if (!raw) return emptyDB();
        try {
          const parsed = JSON.parse(raw);
          const base = emptyDB();
          for (const day of Object.keys(base)) {
            if (!Array.isArray(parsed[day])) parsed[day] = [];
          }
          return parsed;
        } catch {
          return emptyDB();
        }
      }

      function emptyDB() {
        return DAYS.reduce((acc, d) => (acc[d.key] = [], acc), {});
      }

      function saveDB() {
        localStorage.setItem(LS_KEY, JSON.stringify(state.db));
        renderCards();
        renderStats();
      }

      function uid() {
        return "re_" + Math.random().toString(16).slice(2) + "_" + Date.now().toString(16);
      }



      function downloadText(filename, text, mime = "text/plain;charset=utf-8") {
        const blob = new Blob([text], { type: mime });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
      }

      function sparkleBurst(x, y) {
        const colors = ["#ff7aa8", "#6ad3ff", "#7ae582", "#ffd36a", "#b48cff"];
        for (let i = 0; i < 18; i++) {
          const s = document.createElement("div");
          s.className = "sparkle";
          const dx = (Math.random() * 2 - 1) * (40 + Math.random() * 80);
          const dy = (Math.random() * 2 - 1) * (40 + Math.random() * 80);
          s.style.left = (x + (Math.random() * 2 - 1) * 10) + "px";
          s.style.top = (y + (Math.random() * 2 - 1) * 10) + "px";
          s.style.background = colors[Math.floor(Math.random() * colors.length)];
          s.style.setProperty("--dx", dx + "px");
          s.style.setProperty("--dy", dy + "px");
          document.body.appendChild(s);
          setTimeout(() => s.remove(), 800);
        }
      }

      function setHint(msg) {
        el("hint").textContent = msg || "";
        if (msg) setTimeout(() => el("hint").textContent = "", 1600);
      }

      // ---------- UI: tabs ----------
      function renderDayTabs() {
        const tabs = el("dayTabs");
        tabs.innerHTML = "";
        for (const d of DAYS) {
          const b = document.createElement("button");
          b.type = "button";
          b.className = "chip";
          b.textContent = `${d.emoji} ${d.label}`;
          b.setAttribute("role", "tab");
          b.dataset.day = d.key;
          b.dataset.active = "false";
          b.addEventListener("click", () => setActiveDay(d.key));
          tabs.appendChild(b);
        }
      }

      function setActiveDay(dayKey) {
        state.activeDayKey = dayKey;
        for (const btn of el("dayTabs").querySelectorAll("button.chip")) {
          btn.dataset.active = (btn.dataset.day === dayKey) ? "true" : "false";
          btn.setAttribute("aria-selected", btn.dataset.active);
        }
        const day = DAYS.find(d => d.key === dayKey);
        el("activeDayLabel").textContent = day ? `ì„ íƒ: ${day.emoji} ${day.label}ìš”ì¼` : "";
        renderCards();
        renderStats();
      }

      function setTodayChip() {
        const day = DAYS.find(d => d.key === guessTodayKey());
        el("todayChip").textContent = day ? `ì˜¤ëŠ˜(${day.label})ë„ ê¸°ë¡í•´ìš” âœ¨` : "";
      }

      // ---------- Form ----------
      function wireForm() {
        // ë‚ ì§œ ê¸°ë³¸ê°’: ì˜¤ëŠ˜
        el("dateRead").value = new Date().toISOString().slice(0, 10);

        // ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸°
        el("photo").addEventListener("change", async (e) => {
          const file = e.target.files?.[0];
          if (!file) {
            // ìˆ˜ì • ëª¨ë“œì—ì„œ ì‚¬ì§„ ì…ë ¥ì„ ë¹„ìš°ë©´: ê¸°ì¡´ ì‚¬ì§„ ìœ ì§€(ê¸°ë³¸)
            // ì‚¬ìš©ìê°€ "ì‚¬ì§„ ì œê±°"ë¥¼ ì›í•˜ë©´ ì•„ë˜ì˜ remove ë²„íŠ¼ ê°™ì€ ê±¸ ì¶”ê°€í•´ì•¼ í•¨.
            return;
          }
          const dataUrl = await fileToDataUrl(file);
          setPreview(dataUrl, file.name);
        });

        // ì €ì¥/ìˆ˜ì • ì €ì¥
        el("logForm").addEventListener("submit", async (e) => {
          e.preventDefault();

          if (state.editing.on) {
            await saveEdit();
          } else {
            await saveNew();
          }
        });

        // Ctrl+Enter ì €ì¥
        document.addEventListener("keydown", (e) => {
          if (e.ctrlKey && e.key === "Enter") el("btnSave").click();
        });

        el("btnClearForm").addEventListener("click", () => {
          if (state.editing.on) {
            // ìˆ˜ì • ì¤‘ì´ë©´ ì…ë ¥ë§Œ ì§€ìš°ì§€ ë§ê³  ì·¨ì†Œë¥¼ ìœ ë„
            setHint("ìˆ˜ì • ì¤‘ì´ì—ìš”. ì·¨ì†Œ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì¢…ë£Œí•  ìˆ˜ ìˆì–´ìš”.");
            return;
          }
          clearForm({ keepDay: true, keepDate: true });
        });
      }

      async function saveNew() {
        const record = await buildRecordFromForm({ mode: "new" });
        state.db[state.activeDayKey].unshift(record);
        saveDB();
        clearForm({ keepDay: true, keepDate: true });
        setHint("ì €ì¥ ì™„ë£Œ! (ìë™ ì €ì¥ë¨) âœ¨");
        const rect = el("btnSave").getBoundingClientRect();
        sparkleBurst(rect.left + rect.width / 2, rect.top + rect.height / 2);
      }

      async function saveEdit() {
        const dayKey = state.editing.originalDayKey;
        const recordId = state.editing.recordId;

        const { rec, index } = findRecord(dayKey, recordId);
        if (!rec) {
          exitEditMode();
          alert("ìˆ˜ì •í•  ê¸°ë¡ì„ ì°¾ì§€ ëª»í–ˆì–´ìš”. ëª©ë¡ì„ ìƒˆë¡œê³ ì¹¨í•´ ì£¼ì„¸ìš”.");
          return;
        }

        const updated = await buildRecordFromForm({ mode: "edit", existing: rec });

        // (ì„ íƒ) ìˆ˜ì •ì¼ ê¸°ë¡
        updated.updatedAt = new Date().toISOString();
        updated.id = rec.id;          // id ìœ ì§€
        updated.createdAt = rec.createdAt; // ìƒì„±ì¼ ìœ ì§€

        state.db[dayKey][index] = updated;
        saveDB();

        exitEditMode();
        clearForm({ keepDay: true, keepDate: true });
        setHint("ìˆ˜ì • ì €ì¥ ì™„ë£Œ! âœ¨");
        const rect = el("btnSave").getBoundingClientRect();
        sparkleBurst(rect.left + rect.width / 2, rect.top + rect.height / 2);
      }

      function setPreview(dataUrl, name = "") {
        const thumb = el("thumb");
        const text = el("previewText");
        if (!dataUrl) {
          thumb.innerHTML = `<span>ğŸ–¼ï¸</span>`;
          text.textContent = "ì‚¬ì§„ì„ ì„ íƒí•˜ë©´ ë¯¸ë¦¬ë³´ê¸°ê°€ ë³´ì—¬ìš”. (ì €ì¥ì€ base64ë¡œ localStorageì— ì €ì¥)";
          thumb.dataset.dataurl = "";
          return;
        }
        thumb.innerHTML = "";
        const img = document.createElement("img");
        img.src = dataUrl;
        thumb.appendChild(img);
        thumb.dataset.dataurl = dataUrl;
        text.textContent = name ? `ì„ íƒë¨: ${name}` : "ì‚¬ì§„ ì„ íƒë¨";
      }

      function clearForm({ keepDay = false, keepDate = false } = {}) {
        el("title").value = "";
        el("author").value = "";
        if (!keepDate) el("dateRead").value = new Date().toISOString().slice(0, 10);
        el("category").value = "";
        el("rating").value = "";
        el("textColor").value = "#2b2b2b";
        el("note").value = "";
        el("tags").value = "";
        el("photo").value = "";
        setPreview(null);
      }

      function fileToDataUrl(file) {
        return new Promise((resolve, reject) => {
          const r = new FileReader();
          r.onload = () => resolve(String(r.result));
          r.onerror = reject;
          r.readAsDataURL(file);
        });
      }

      function parseTags(str) {
        return (str || "")
          .split(",")
          .map(t => t.trim())
          .filter(Boolean);
      }

      async function buildRecordFromForm({ mode, existing }) {
        const title = el("title").value.trim();
        const author = el("author").value.trim();
        const dateRead = el("dateRead").value || "";
        const category = el("category").value || "";
        const rating = el("rating").value || "";
        const textColor = el("textColor").value || "#2b2b2b";
        const note = el("note").value || "";
        const tags = parseTags(el("tags").value);

        // ì‚¬ì§„ ì²˜ë¦¬:
        // - new: ë¯¸ë¦¬ë³´ê¸° dataurl ê·¸ëŒ€ë¡œ
        // - edit: ìƒˆ íŒŒì¼ ì„ íƒí–ˆìœ¼ë©´ ê·¸ê±¸ ì‚¬ìš©, ì•„ë‹ˆë©´ ê¸°ì¡´ ì‚¬ì§„ ìœ ì§€
        const previewDataUrl = el("thumb").dataset.dataurl || "";
        let photoDataUrl = previewDataUrl;

        if (mode === "edit") {
          if (!previewDataUrl) {
            // ê¸°ì¡´ ì´ë¯¸ì§€ ìœ ì§€
            photoDataUrl = existing?.photoDataUrl || "";
          }
        }

        return {
          id: mode === "new" ? uid() : existing?.id,
          createdAt: mode === "new" ? new Date().toISOString() : existing?.createdAt,
          title,
          author,
          dateRead,
          category,
          rating,
          textColor,
          note,
          tags,
          photoDataUrl
        };
      }

      // ---------- Edit mode UI ----------
      function enterEditMode(dayKey, recordId) {
        state.editing.on = true;
        state.editing.recordId = recordId;
        state.editing.originalDayKey = dayKey;

        const { rec } = findRecord(dayKey, recordId);
        if (!rec) {
          exitEditMode();
          return;
        }

        // í¼ì— ì±„ìš°ê¸°
        el("title").value = rec.title || "";
        el("author").value = rec.author || "";
        el("dateRead").value = rec.dateRead || "";
        el("category").value = rec.category || "";
        el("rating").value = rec.rating || "";
        el("textColor").value = rec.textColor || "#2b2b2b";
        el("note").value = rec.note || "";
        el("tags").value = (rec.tags || []).join(", ");
        el("photo").value = ""; // íŒŒì¼ ì¸í’‹ì€ ë³´ì•ˆìƒ ì±„ìš¸ ìˆ˜ ì—†ìŒ

        if (rec.photoDataUrl) {
          setPreview(rec.photoDataUrl, "ê¸°ì¡´ ì‚¬ì§„");
        } else {
          setPreview(null);
        }

        // UI í…ìŠ¤íŠ¸ ë³€ê²½
        el("formTitle").textContent = "âœï¸ ê¸°ë¡ ìˆ˜ì •";
        el("formSubtitle").textContent = "ìˆ˜ì • í›„ 'âœ… ìˆ˜ì • ì €ì¥'ì„ ëˆ„ë¥´ì„¸ìš”. (ì‚¬ì§„ì€ ìƒˆë¡œ ì„ íƒí•˜ì§€ ì•Šìœ¼ë©´ ìœ ì§€ë¼ìš”)";
        el("btnSave").textContent = "âœ… ìˆ˜ì • ì €ì¥";
        el("editBanner").dataset.on = "true";
        el("editInfo").textContent = `ì„ íƒ ê¸°ë¡: ${rec.title || "(ì œëª© ì—†ìŒ)"} Â· (${dayLabel(dayKey)}ìš”ì¼)`;

        // ë³´ê¸° ì¢‹ê²Œ ìŠ¤í¬ë¡¤
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      function exitEditMode() {
        state.editing.on = false;
        state.editing.recordId = null;
        state.editing.originalDayKey = null;

        el("formTitle").textContent = "âœï¸ ì˜¤ëŠ˜ì˜ ê¸°ë¡";
        el("formSubtitle").textContent = "ìš”ì¼ íƒ­ì„ ê³ ë¥´ê³ , ì±… ì •ë³´ë¥¼ ì ì–´ ì €ì¥í•˜ì„¸ìš”.";
        el("btnSave").textContent = "âœ¨ ì €ì¥í•˜ê¸°";
        el("editBanner").dataset.on = "false";
      }

      function wireEditCancel() {
        el("btnCancelEdit").addEventListener("click", () => {
          exitEditMode();
          clearForm({ keepDay: true, keepDate: true });
          setHint("ìˆ˜ì •ì„ ì·¨ì†Œí–ˆì–´ìš”.");
        });
      }

      function dayLabel(dayKey) {
        return DAYS.find(d => d.key === dayKey)?.label || dayKey;
      }

      function findRecord(dayKey, recordId) {
        const arr = state.db[dayKey] || [];
        const index = arr.findIndex(x => x.id === recordId);
        return { rec: index >= 0 ? arr[index] : null, index };
      }

      // ---------- List render ----------
      function renderStats() {
        const day = state.activeDayKey;
        const list = state.db[day] || [];
        const total = Object.values(state.db).reduce((acc, arr) => acc + (arr?.length || 0), 0);

        const stats = el("stats");
        stats.innerHTML = "";

        const dayInfo = DAYS.find(d => d.key === day);
        const pill1 = document.createElement("div");
        pill1.className = "pill";
        pill1.textContent = `${dayInfo?.emoji || "ğŸ“…"} ${dayInfo?.label || ""}ìš”ì¼: ${list.length}ê°œ`;

        const pill2 = document.createElement("div");
        pill2.className = "pill";
        pill2.textContent = `ì „ì²´: ${total}ê°œ`;

        const pill3 = document.createElement("div");
        pill3.className = "pill";
        const withPhotos = list.filter(x => x.photoDataUrl).length;
        pill3.textContent = `ì‚¬ì§„ í¬í•¨: ${withPhotos}ê°œ`;

        stats.appendChild(pill1);
        stats.appendChild(pill2);
        stats.appendChild(pill3);
      }

      function renderCards() {
        const cards = el("cards");
        cards.innerHTML = "";
        const list = state.db[state.activeDayKey] || [];

        if (!list.length) {
          const empty = document.createElement("div");
          empty.className = "muted";
          empty.style.padding = "10px 2px";
          empty.textContent = "ì•„ì§ ê¸°ë¡ì´ ì—†ì–´ìš”. ì™¼ìª½ì—ì„œ ì²« ê¸°ë¡ì„ ì €ì¥í•´ë³´ì„¸ìš” âœ¨";
          cards.appendChild(empty);
          return;
        }

        for (const rec of list) {
          const card = document.createElement("article");
          card.className = "card";
          card.setAttribute("typeof", "schema:Review");
          card.setAttribute("resource", `#${rec.id}`);

          const head = document.createElement("div");
          head.className = "cardHead";

          const cover = document.createElement("div");
          cover.className = "cover";
          if (rec.photoDataUrl) {
            const img = document.createElement("img");
            img.src = rec.photoDataUrl;
            img.alt = "ì²¨ë¶€ ì‚¬ì§„";
            cover.appendChild(img);
          } else {
            cover.innerHTML = "<span>ğŸ“–</span>";
          }

          const meta = document.createElement("div");
          meta.className = "meta";

          const titleLine = document.createElement("div");
          titleLine.className = "titleLine";

          const title = document.createElement("div");
          title.className = "bookTitle";
          title.textContent = rec.title || "(ì œëª© ì—†ìŒ)";
          title.style.color = rec.textColor || "#2b2b2b";
          title.setAttribute("property", "schema:itemReviewed");
          title.setAttribute("typeof", "schema:Book");

          const mini1 = document.createElement("span");
          mini1.className = "mini";
          mini1.textContent = rec.category ? `#${rec.category}` : "ë¶„ë¥˜ ì—†ìŒ";

          const mini2 = document.createElement("span");
          mini2.className = "mini";
          mini2.textContent = rec.rating ? `í‰ì  ${"â­".repeat(Number(rec.rating))}` : "í‰ì  ì—†ìŒ";

          titleLine.appendChild(title);
          titleLine.appendChild(mini1);
          titleLine.appendChild(mini2);

          const sub = document.createElement("div");
          sub.className = "muted";
          const author = rec.author ? `ì €ì: ${rec.author}` : "ì €ì: (ë¯¸ì…ë ¥)";
          const date = rec.dateRead ? `ì½ì€ë‚ : ${rec.dateRead}` : "ì½ì€ë‚ : (ë¯¸ì…ë ¥)";
          sub.textContent = `${author} Â· ${date}`;

          const tags = document.createElement("div");
          tags.className = "muted";
          tags.textContent = rec.tags?.length ? `íƒœê·¸: ${rec.tags.map(t => "#" + t).join(" ")}` : "íƒœê·¸: ì—†ìŒ";

          meta.appendChild(titleLine);
          meta.appendChild(sub);
          meta.appendChild(tags);

          head.appendChild(cover);
          head.appendChild(meta);

          const body = document.createElement("div");
          body.className = "cardBody";

          const note = document.createElement("div");
          note.className = "note";
          note.textContent = rec.note || "ë©”ëª¨ ì—†ìŒ";
          note.style.color = rec.textColor || "#2b2b2b";
          note.setAttribute("property", "schema:reviewBody");

          body.appendChild(note);

          const actions = document.createElement("div");
          actions.className = "cardActions";

          const btnEdit = document.createElement("button");
          btnEdit.className = "smallBtn ghost";
          btnEdit.type = "button";
          btnEdit.textContent = "âœï¸ ìˆ˜ì •";
          btnEdit.addEventListener("click", () => enterEditMode(state.activeDayKey, rec.id));



          const btnDelete = document.createElement("button");
          btnDelete.className = "smallBtn danger";
          btnDelete.type = "button";
          btnDelete.textContent = "ğŸ—‘ï¸ ì‚­ì œ";
          btnDelete.addEventListener("click", () => {
            if (state.editing.on && state.editing.recordId === rec.id) {
              exitEditMode();
              clearForm({ keepDay: true, keepDate: true });
            }
            const arr = state.db[state.activeDayKey] || [];
            state.db[state.activeDayKey] = arr.filter(x => x.id !== rec.id);
            saveDB();
          });

          actions.appendChild(btnEdit);

          actions.appendChild(btnDelete);

          card.appendChild(head);
          card.appendChild(body);
          card.appendChild(actions);

          cards.appendChild(card);
        }
      }



      // ---------- Backup/Restore ----------
      function wireBackupRestore() {
        el("btnBackup").addEventListener("click", () => {
          const payload = {
            app: "readingLogs",
            version: "v1",
            exportedAt: new Date().toISOString(),
            db: state.db
          };
          downloadText(
            `reading-logs-backup-${new Date().toISOString().slice(0, 10)}.json`,
            JSON.stringify(payload, null, 2),
            "application/json;charset=utf-8"
          );
          const r = el("btnBackup").getBoundingClientRect();
          sparkleBurst(r.left + r.width / 2, r.top + r.height / 2);
        });

        const fileInput = el("restoreFile");
        el("btnRestore").addEventListener("click", () => fileInput.click());

        fileInput.addEventListener("change", async (e) => {
          const file = e.target.files?.[0];
          if (!file) return;

          try {
            const text = await file.text();
            const parsed = JSON.parse(text);

            if (!parsed || typeof parsed !== "object" || !parsed.db) {
              alert("ë°±ì—… íŒŒì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•Šì•„ìš”.");
              return;
            }

            const base = emptyDB();
            for (const day of Object.keys(base)) {
              if (!Array.isArray(parsed.db[day])) parsed.db[day] = [];
            }

            const ok = confirm("ì´ ë°±ì—…ìœ¼ë¡œ í˜„ì¬ ê¸°ë¡ì„ ë®ì–´ì“¸ê¹Œìš”? (ë˜ëŒë¦´ ìˆ˜ ì—†ì–´ìš”)");
            if (!ok) return;

            // ìˆ˜ì • ëª¨ë“œë¼ë©´ ì¢…ë£Œ
            exitEditMode();
            state.db = parsed.db;
            saveDB();
            const r = el("btnRestore").getBoundingClientRect();
            sparkleBurst(r.left + r.width / 2, r.top + r.height / 2);
            alert("ë³µì› ì™„ë£Œ!");
          } catch {
            alert("ë³µì›ì— ì‹¤íŒ¨í–ˆì–´ìš”. íŒŒì¼ì´ JSON í˜•ì‹ì¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.");
          } finally {
            fileInput.value = "";
            clearForm({ keepDay: true, keepDate: true });
          }
        });
      }

      // ---------- Reset ----------
      function wireReset() {
        el("btnReset").addEventListener("click", () => {
          if (!confirm("ì •ë§ë¡œ ì „ì²´ ê¸°ë¡ì„ ì‚­ì œí• ê¹Œìš”? (ë˜ëŒë¦´ ìˆ˜ ì—†ì–´ìš”)")) return;
          exitEditMode();
          state.db = emptyDB();
          saveDB();
          clearForm({ keepDay: true, keepDate: true });
        });
      }

      function generateBaepsaeFlock(count) {
        for (let i = 0; i < count; i++) {
          const div = document.createElement("div");
          div.className = "baepsae-container mini bg-baepsae";

          // Random Grid Position
          const top = Math.random() * 90 + 5; // 5% ~ 95%
          const left = Math.random() * 90 + 5;
          div.style.top = top + "%";
          div.style.left = left + "%";

          // Random Transform
          const scale = 0.5 + Math.random() * 0.8;
          const rot = (Math.random() * 40 - 20) + "deg";
          const flip = Math.random() > 0.5 ? "scaleX(-1) " : "";
          div.style.transform = `${flip} rotate(${rot}) scale(${scale})`;

          // Random Animation Delay
          div.style.animationDelay = (Math.random() * 2) + "s";
          div.style.animationDuration = (2 + Math.random() * 2) + "s";

          // HTML
          div.innerHTML = `
            <div class="wing left"></div>
            <div class="wing right"></div>
            <div class="baepsae">
              <div class="cheek left"></div>
              <div class="cheek right"></div>
              <div class="beak"></div>
            </div>
          `;
          document.body.appendChild(div);
        }
      }
    })();
  </script>
</body>

</html>